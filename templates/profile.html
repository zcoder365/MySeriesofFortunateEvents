{% extends "base.html" %}
{% block content %}
<div class="profile-info">
    <div class="profile-info-username">
        <p>Username:</p>
        <p>{{ username }}</p>
    </div>
    <div class="profile-info-streak">
        <p>Current Streak:</p>
        <p>{{ streak }}</p>
    </div>
    <div class="profile-info-entries">
        <p>Total Entries:</p>
        <p>{{ num_entries }}</p>
    </div>
    <div class="profile-info-reset">
        <form action="{{ url_for('reset_password') }}" method="get" style="margin-top: 16px;">
            <button type="submit">Reset Password</button>
        </form>
    </div>
</div>

<div class="charts-container">
    <div class="chart-block">
        <h3 style="text-align:center;">This Week's Ratings</h3>
        <canvas id="ratingsChart" aria-label="Bar chart of entry ratings" role="img"></canvas>
        <div class="stats-block">
            <h4 style="margin-top:30px;">This Week's Stats</h4>
            <table class="stats-table">
                <tr>
                    <th>Average Rating</th>
                    <td>{{ week_avg_rating }}</td>
                </tr>
                <tr>
                    <th>Highest Rating</th>
                    <td>{{ week_max_rating }}</td>
                </tr>
                <tr>
                    <th>Lowest Rating</th>
                    <td>{{ week_min_rating }}</td>
                </tr>
                <tr>
                    <th>Total Entries</th>
                    <td>{{ week_total_entries }}</td>
                </tr>
            </table>
        </div>
    </div>
    <div class="chart-block">
        <h3 style="text-align:center;">This Month's Ratings</h3>
        <canvas id="ratingsChartMonth" aria-label="Bar chart of entry ratings for the month" role="img"></canvas>
        <div class="stats-block">
            <h4 style="margin-top:30px;">This Month's Stats</h4>
            <table class="stats-table">
                <tr>
                    <th>Average Rating</th>
                    <td>{{ month_avg_rating }}</td>
                </tr>
                <tr>
                    <th>Highest Rating</th>
                    <td>{{ month_max_rating }}</td>
                </tr>
                <tr>
                    <th>Lowest Rating</th>
                    <td>{{ month_min_rating }}</td>
                </tr>
                <tr>
                    <th>Total Entries</th>
                    <td>{{ month_total_entries }}</td>
                </tr>
            </table>
        </div>
    </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    window.chartLabels = {{ chart_labels|tojson | safe }};
    window.chartData = {{ chart_data|tojson | safe }};
    window.chartLabelsMonth = {{ chart_labels_month|tojson | safe }};
    window.chartDataMonth = {{ chart_data_month|tojson | safe }};
</script>
<script src="{{ url_for('static', filename='ratingsChart.js') }}"></script>
<script src="{{ url_for('static', filename='ratingsChartMonth.js') }}"></script>
{% endblock %}