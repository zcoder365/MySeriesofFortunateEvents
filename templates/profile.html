{% extends "base.html" %}
{% block content %}
<div class="profile-info">
    <div class="profile-info-username">
        <p>Username:</p>
        <p>{{ username }}</p>
    </div>
    <div class="profile-info-streak">
        <p>Current Streak:</p>
        <p>{{ streak }}</p>
    </div>
    <div class="profile-info-entries">
        <p>Total Entries:</p>
        <p>{{ num_entries }}</p>
    </div>
    <div class="profile-info-reset">
        <form action="{{ url_for('reset_password') }}" method="get" style="margin-top: 16px;">
            <button type="submit" class="btn btn-warning">Reset Password</button>
        </form>
    </div>
</div>

<div class="charts-container">
    <div class="chart-block">
        <h3 style="text-align:center;">This Week's Ratings</h3>
        <canvas id="ratingsChart" aria-label="Bar chart of entry ratings" role="img"></canvas>
        <div class="stats-block">
            <h4 style="margin-top:30px;">This Week's Stats</h4>
            <ul>
                <li>Average Rating: {{ week_avg_rating }}</li>
                <li>Highest Rating: {{ week_max_rating }}</li>
                <li>Lowest Rating: {{ week_min_rating }}</li>
                <li>Total Entries: {{ week_total_entries }}</li>
            </ul>
        </div>
    </div>
    <div class="chart-block">
        <h3 style="text-align:center;">This Month's Ratings</h3>
        <canvas id="ratingsChartMonth" aria-label="Bar chart of entry ratings for the month" role="img"></canvas>
        <div class="stats-block">
            <h4 style="margin-top:30px;">This Month's Stats</h4>
            <ul>
                <li>Average Rating: {{ month_avg_rating }}</li>
                <li>Highest Rating: {{ month_max_rating }}</li>
                <li>Lowest Rating: {{ month_min_rating }}</li>
                <li>Total Entries: {{ month_total_entries }}</li>
            </ul>
        </div>
    </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    window.chartLabels = {{ chart_labels|tojson | safe }};
    window.chartData = {{ chart_data|tojson | safe }};
    window.chartLabelsMonth = {{ chart_labels_month|tojson | safe }};
    window.chartDataMonth = {{ chart_data_month|tojson | safe }};
</script>
<script src="{{ url_for('static', filename='ratingsChart.js') }}"></script>
<script src="{{ url_for('static', filename='ratingsChartMonth.js') }}"></script>
{% endblock %}